% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={TASK3： 数据操作-综合分析},
  pdfauthor={姚震林 202411422339},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{TASK3： 数据操作-综合分析}
\author{姚震林 202411422339}
\date{2024-11-04}

\begin{document}
\maketitle

\subsection{1.}\label{section}

对矩阵进行如下操作：

\textbf{a}. 在 \texttt{R} 中生成矩阵\(A\)： \[A = \begin{bmatrix}
1 & 2 & 3 \\
4 & 2 & 1 \\
2 & 3 & 0
\end{bmatrix}\]

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ A\_entries }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{0}\NormalTok{)}
\SpecialCharTok{\textgreater{}}\NormalTok{ A }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(A\_entries, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{byrow =}\NormalTok{ T)}
\SpecialCharTok{\textgreater{}} \FunctionTok{print}\NormalTok{(A)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    2    1
## [3,]    2    3    0
\end{verbatim}

\textbf{b}. 计算矩阵\(A\)的转置矩阵\(B\), 以及逆矩阵\(C\)

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ B }\OtherTok{=} \FunctionTok{t}\NormalTok{(A)}
\SpecialCharTok{\textgreater{}}\NormalTok{ C }\OtherTok{=} \FunctionTok{solve}\NormalTok{(A)}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"转置矩阵 B:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} \FunctionTok{print}\NormalTok{(B)}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"逆矩阵 C:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} \FunctionTok{print}\NormalTok{(C)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 转置矩阵 B:
##      [,1] [,2] [,3]
## [1,]    1    4    2
## [2,]    2    2    3
## [3,]    3    1    0
## 逆矩阵 C:
##       [,1]  [,2]  [,3]
## [1,] -0.12  0.36 -0.16
## [2,]  0.08 -0.24  0.44
## [3,]  0.32  0.04 -0.24
\end{verbatim}

\textbf{c}. 求矩阵\(A\)和矩阵\(B\)的乘积

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ prod }\OtherTok{=}\NormalTok{ A }\SpecialCharTok{\%*\%}\NormalTok{ B}
\SpecialCharTok{\textgreater{}} \FunctionTok{print}\NormalTok{(prod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]   14   11    8
## [2,]   11   21   14
## [3,]    8   14   13
\end{verbatim}

\subsection{2.}\label{section-1}

使用电视剧网播量数据集，该数据集收集了 4266
条电视剧的信息。请完成以下任务。

\textbf{a}. 获取数据集，查看数据概况；

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ tv\_data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"电视剧播量.csv"}\NormalTok{, }\AttributeTok{fileEncoding =} \StringTok{"GBK"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} \FunctionTok{head}\NormalTok{(tv\_data)}
\SpecialCharTok{\textgreater{}} \FunctionTok{summary}\NormalTok{(tv\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           剧名                                    类型 播放量    点赞    差评
## 1   花千骨2015            言情剧\n/\n穿越剧\n/\n网络剧 3.07亿 992,342 357,808
## 2 还珠格格2015          古装剧\n\n/\n喜剧\n\n/\n网络剧 73.3万   2,352   7,240
## 3         天局 武侠剧\n/\n古装剧\n/\n悬疑剧\n/\n网络剧 3454万  38,746   3,593
## 4     明若晓溪            青春剧\n/\n言情剧\n/\n偶像剧 1.57亿 518,660  72,508
## 5     多情江山            言情剧\n/\n古装剧\n/\n宫廷剧 1126万  22,553   6,955
## 6   我是机器人                       偶像剧\n\n/\n喜剧 1660万  37,905   3,605
##   得分           采集日期
## 1  7.3 2015-9-23 23:48:48
## 2  2.5 2015-9-23 23:48:48
## 3  9.2 2015-9-23 23:48:52
## 4  8.8 2015-9-23 23:48:51
## 5  7.6 2015-9-23 23:48:52
## 6  9.1 2015-9-23 23:48:51
##      剧名               类型              播放量              点赞          
##  Length:4266        Length:4266        Length:4266        Length:4266       
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##      差评               得分             采集日期        
##  Length:4266        Length:4266        Length:4266       
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character
\end{verbatim}

\textbf{b}. 删除数据集中剧名缺失的值

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ missing\_count }\OtherTok{=} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(tv\_data}\SpecialCharTok{$}\NormalTok{剧名) }\SpecialCharTok{|}\NormalTok{ tv\_data}\SpecialCharTok{$}\NormalTok{剧名 }\SpecialCharTok{==} \StringTok{""}\NormalTok{)  }\CommentTok{\#检查剧名中有几个缺失值NA or 为空的}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"剧名缺失或为空的行数是:"}\NormalTok{, missing\_count,}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}}\NormalTok{ tv\_data\_clean }\OtherTok{=}\NormalTok{ tv\_data[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(tv\_data}\SpecialCharTok{$}\NormalTok{剧名), ] }\CommentTok{\#执行删除命令anyway}
\SpecialCharTok{\textgreater{}} \FunctionTok{summary}\NormalTok{(tv\_data\_clean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 剧名缺失或为空的行数是: 0 
##      剧名               类型              播放量              点赞          
##  Length:4266        Length:4266        Length:4266        Length:4266       
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##      差评               得分             采集日期        
##  Length:4266        Length:4266        Length:4266       
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character
\end{verbatim}

\textbf{c}. 不考虑缺失数据影响，计算电视剧的平均得分。

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ mean\_score }\OtherTok{=} \FunctionTok{mean}\NormalTok{(tv\_data}\SpecialCharTok{$}\NormalTok{得分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\CommentTok{\#忽略缺失值的情况下计算样本均值}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"不考虑缺失数据的电视剧平均得分为:"}\NormalTok{, mean\_score,}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 不考虑缺失数据的电视剧平均得分为: NA
\end{verbatim}

很明显，这里的变量 \texttt{tv\_data\$得分}中出现了非
\texttt{numeric}的变量，

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ tv\_scoring }\OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(tv\_data}\SpecialCharTok{$}\NormalTok{得分) }\CommentTok{\#将非数值变量转换为NA}
\SpecialCharTok{\textgreater{}}\NormalTok{ tv\_sc\_mean }\OtherTok{=} \FunctionTok{mean}\NormalTok{(tv\_scoring,}\AttributeTok{na.rm =}\NormalTok{ T) }\CommentTok{\#使用na.rm参数来计算忽略NA之后的mean}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"不考虑缺失数据的电视剧平均得分为:"}\NormalTok{, tv\_sc\_mean,}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 不考虑缺失数据的电视剧平均得分为: 7.592556
\end{verbatim}

\subsection{3.}\label{section-2}

\textbf{a}. 获取数据集，查看数据概况。

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ mbgame }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"安卓手机游戏.csv"}\NormalTok{, }\AttributeTok{fileEncoding =} \StringTok{"GBK"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} \FunctionTok{head}\NormalTok{(mbgame)}
\SpecialCharTok{\textgreater{}} \FunctionTok{summary}\NormalTok{(mbgame)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             游戏名称 评分     类别 语言 热度 最后更新时间 游戏版本     资费
## 1           捕鱼达人  7.6 益智休闲 中文  95℃   2015-07-29    1.9.0 道具收费
## 2            NBA2K14  7.5 体育运动 中文  94℃   2014-05-27      1.3 完全免费
## 3 愤怒的小鸟六周年版  5.9 益智休闲 中文  93℃   2016-09-29    6.0.3 道具收费
## 4       三国志无双战  5.1 动作游戏 中文  90℃   2012-07-31      1.3 完全免费
## 5      地铁跑酷-冰岛  8.4 益智休闲 中文  89℃   2016-09-23   2.54.0 道具收费
## 6           火箭飞人  8.2 动作游戏 英文  89℃   2016-08-30   1.9.10 完全免费
##                     开发商  支持系统 评论数 喜欢数
## 1                 触控科技   2.3以上   6654    114
## 2                 2K Games   4.0以上  16190   3712
## 3 拓维信息系统股份有限公司   2.3以上   7187    280
## 4       PlayBean Co., Ltd.   2.2以上   9372   1608
## 5                     乐逗   4.0以上   8804    888
## 6        Halfbrick Studios 4.0.3以上   7371    544
##    游戏名称              评分           类别               语言          
##  Length:1141        Min.   :1.000   Length:1141        Length:1141       
##  Class :character   1st Qu.:5.200   Class :character   Class :character  
##  Mode  :character   Median :6.600   Mode  :character   Mode  :character  
##                     Mean   :6.611                                        
##                     3rd Qu.:7.900                                        
##                     Max.   :9.600                                        
##                     NA's   :203                                          
##      热度           最后更新时间         游戏版本             资费          
##  Length:1141        Length:1141        Length:1141        Length:1141       
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##                                                                             
##                                                                             
##                                                                             
##                                                                             
##     开发商            支持系统             评论数          喜欢数       
##  Length:1141        Length:1141        Min.   :    0   Min.   :    0.0  
##  Class :character   Class :character   1st Qu.:  446   1st Qu.:   67.0  
##  Mode  :character   Mode  :character   Median :  859   Median :  233.0  
##                                        Mean   : 2322   Mean   :  786.3  
##                                        3rd Qu.: 2510   3rd Qu.:  854.8  
##                                        Max.   :96354   Max.   :13323.0  
##                                        NA's   :1       NA's   :1
\end{verbatim}

\textbf{b}.
提取热度中的数值部分，计算各游戏类型的热度均值，找出平均热度最高的游戏类型。

经debugging，检查到本数据 \texttt{安卓手机游戏.csv}
的最后一行为\texttt{,,,,,,,,,,,}, 数据分析时忽略最后一行

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ mbgame }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"安卓手机游戏.csv"}\NormalTok{, }\AttributeTok{fileEncoding =} \StringTok{"GBK"}\NormalTok{)[}\DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(mbgame)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{),]}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}} \FunctionTok{library}\NormalTok{(plyr)}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}}\NormalTok{ mbgame}\SpecialCharTok{$}\NormalTok{热度数值 }\OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{gsub}\NormalTok{(}\StringTok{"[\^{}0{-}9]"}\NormalTok{, }\StringTok{""}\NormalTok{, mbgame}\SpecialCharTok{$}\NormalTok{热度)) }\CommentTok{\#将°C替换为空，然后转换为数值类型}
\SpecialCharTok{\textgreater{}}\NormalTok{ avheat }\OtherTok{=} \FunctionTok{ddply}\NormalTok{(mbgame, .(类别), }\ControlFlowTok{function}\NormalTok{(x) \{}\FunctionTok{mean}\NormalTok{(x}\SpecialCharTok{$}\NormalTok{热度数值)\})}
\SpecialCharTok{\textgreater{}}\NormalTok{ avheat\_withunit }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(类别 }\OtherTok{=}\NormalTok{ avheat}\SpecialCharTok{$}\NormalTok{类别,}
\SpecialCharTok{+}\NormalTok{                              平均热度 }\OtherTok{=} \FunctionTok{paste}\NormalTok{(avheat}\SpecialCharTok{$}\NormalTok{V1,}\StringTok{"°C"}\NormalTok{))}
\SpecialCharTok{\textgreater{}}\NormalTok{ highestheat }\OtherTok{=}\NormalTok{ avheat\_withunit[}\FunctionTok{which.max}\NormalTok{(avheat}\SpecialCharTok{$}\NormalTok{V1), ]}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}} 
\ErrorTok{\textgreater{}} \FunctionTok{print}\NormalTok{(avheat\_withunit)}
\SpecialCharTok{\textgreater{}} \FunctionTok{cat}\NormalTok{(}\StringTok{"最高平均热度的游戏类型为:"}\NormalTok{,highestheat[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{],}\StringTok{"平均热度为"}\NormalTok{,highestheat[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{], }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        类别            平均热度
## 1  策略塔防 40.8888888888889 °C
## 2  动作游戏 42.6029411764706 °C
## 3  飞行游戏 41.6486486486486 °C
## 4  格斗游戏 40.5714285714286 °C
## 5  角色扮演 42.1929824561403 °C
## 6  竞速游戏 45.6117647058824 °C
## 7  冒险解谜 39.5232558139535 °C
## 8  模拟经营 38.3207547169811 °C
## 9  棋牌游戏 37.0555555555556 °C
## 10 射击游戏 39.9636363636364 °C
## 11 体育运动 45.9782608695652 °C
## 12 养成游戏 42.3333333333333 °C
## 13 益智休闲 41.7979452054795 °C
## 14 音乐游戏             40.6 °C
## 15 游戏工具 43.6153846153846 °C
## 最高平均热度的游戏类型为: 体育运动 平均热度为 45.9782608695652 °C
\end{verbatim}

\textbf{c}.
计算各游戏类型的平均评分、最高评分、最低评分、评分标准差，并作简要分析。

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(mbgame}\SpecialCharTok{$}\NormalTok{评分))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 202
\end{verbatim}

经检查，\texttt{评分} 变量中有空值

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}} \FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程序包：'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:plyr':
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ game\_stats }\OtherTok{=}\NormalTok{ mbgame }\SpecialCharTok{\%\textgreater{}\%}
\SpecialCharTok{+}   \FunctionTok{group\_by}\NormalTok{(类别) }\SpecialCharTok{\%\textgreater{}\%}
\SpecialCharTok{+}   \FunctionTok{summarize}\NormalTok{(}
\SpecialCharTok{+}\NormalTok{     平均评分 }\OtherTok{=} \FunctionTok{mean}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{     最高评分 }\OtherTok{=} \FunctionTok{max}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{     最低评分 }\OtherTok{=} \FunctionTok{min}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{     评分标准差 }\OtherTok{=} \FunctionTok{sd}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\SpecialCharTok{+}\NormalTok{   )}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}} \CommentTok{\# 打印结果}
\ErrorTok{\textgreater{}} \FunctionTok{print}\NormalTok{(game\_stats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 15 x 5
##    类别     平均评分 最高评分 最低评分 评分标准差
##    <chr>       <dbl>    <dbl>    <dbl>      <dbl>
##  1 体育运动     6.84      8.8      4.9       1.46
##  2 养成游戏     6.55      8.3      5         1.23
##  3 冒险解谜     6.86      9        4.8       1.23
##  4 动作游戏     6.65      9        1         1.44
##  5 射击游戏     6.61      8.6      4.7       1.30
##  6 格斗游戏     6.78      8.8      5         1.18
##  7 棋牌游戏     5.84      8.1      4.5       1.22
##  8 模拟经营     6.67      9.3      4.7       1.28
##  9 游戏工具     5.03      6.4      1         1.63
## 10 益智休闲     6.46      9.6      4.6       1.31
## 11 竞速游戏     6.37      8.8      4.7       1.35
## 12 策略塔防     6.88      9.3      4.8       1.39
## 13 角色扮演     7.00      9.1      4.6       1.33
## 14 音乐游戏     6.4       9        5         1.34
## 15 飞行游戏     5.70      8.2      4.7       1.09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}}\NormalTok{ game\_stats }\OtherTok{=} \FunctionTok{summarize}\NormalTok{(}
\SpecialCharTok{+}   \FunctionTok{group\_by}\NormalTok{(mbgame, 类别),}
\SpecialCharTok{+}\NormalTok{   平均评分 }\OtherTok{=} \FunctionTok{mean}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{   最高评分 }\OtherTok{=} \FunctionTok{max}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{   最低评分 }\OtherTok{=} \FunctionTok{min}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\SpecialCharTok{+}\NormalTok{   评分标准差 }\OtherTok{=} \FunctionTok{sd}\NormalTok{(评分, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\SpecialCharTok{+}\NormalTok{ )}
\SpecialCharTok{\textgreater{}} \FunctionTok{print}\NormalTok{(game\_stats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 15 x 5
##    类别     平均评分 最高评分 最低评分 评分标准差
##    <chr>       <dbl>    <dbl>    <dbl>      <dbl>
##  1 体育运动     6.84      8.8      4.9       1.46
##  2 养成游戏     6.55      8.3      5         1.23
##  3 冒险解谜     6.86      9        4.8       1.23
##  4 动作游戏     6.65      9        1         1.44
##  5 射击游戏     6.61      8.6      4.7       1.30
##  6 格斗游戏     6.78      8.8      5         1.18
##  7 棋牌游戏     5.84      8.1      4.5       1.22
##  8 模拟经营     6.67      9.3      4.7       1.28
##  9 游戏工具     5.03      6.4      1         1.63
## 10 益智休闲     6.46      9.6      4.6       1.31
## 11 竞速游戏     6.37      8.8      4.7       1.35
## 12 策略塔防     6.88      9.3      4.8       1.39
## 13 角色扮演     7.00      9.1      4.6       1.33
## 14 音乐游戏     6.4       9        5         1.34
## 15 飞行游戏     5.70      8.2      4.7       1.09
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{\textgreater{}} \FunctionTok{library}\NormalTok{(ggplot2)}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}} \FunctionTok{library}\NormalTok{(tidyr)}
\SpecialCharTok{\textgreater{}}\NormalTok{ game\_stats\_long }\OtherTok{=}\NormalTok{ game\_stats }\SpecialCharTok{\%\textgreater{}\%}
\SpecialCharTok{+}   \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(平均评分, 最高评分, 最低评分),}
\SpecialCharTok{+}                \AttributeTok{names\_to =} \StringTok{"评分类型"}\NormalTok{,}
\SpecialCharTok{+}                \AttributeTok{values\_to =} \StringTok{"评分"}\NormalTok{)}
\SpecialCharTok{\textgreater{}} 
\ErrorTok{\textgreater{}} \FunctionTok{ggplot}\NormalTok{(game\_stats\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ 类别, }\AttributeTok{y =}\NormalTok{ 评分, }\AttributeTok{fill =}\NormalTok{ 评分类型)) }\SpecialCharTok{+}
\SpecialCharTok{+}   \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
\SpecialCharTok{+}   \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"各游戏类型评分统计"}\NormalTok{,}
\SpecialCharTok{+}        \AttributeTok{x =} \StringTok{"游戏类型"}\NormalTok{,}
\SpecialCharTok{+}        \AttributeTok{y =} \StringTok{"评分"}\NormalTok{) }\SpecialCharTok{+}
\SpecialCharTok{+}   \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
\SpecialCharTok{+}   \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{1233_files/figure-latex/unnamed-chunk-13-1.pdf}

由结果可知，\texttt{游戏工具}这一类游戏，平均分，最高分，最低分都是最低的，与此同时波动还大；此外其他类型的游戏之间差距不是太大

\end{document}
